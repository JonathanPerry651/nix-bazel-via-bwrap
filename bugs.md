# we don't need both the gazelle nix_cache_name directive and the name arg to the nix_lock tag_class.  we should remove all the gazelle directives, and just pick it all up from the tag_class arguments.
# the lockfile arg isn't properly propagated through - no matter what you pass it there gazelle still tries to write to //nix_deps:nix.lock
# when the lock file write fails, gazelle emits a warning instead of a hard fail.  The source tree is left in an unrunnable state, which is not what we want, so we should just hard-fail
# the environment created by the runner for nix_flake_run_under is complete, in that a client can find the entrypoint in /nix/store/<hash>/bin/<whatever>, but that is obviously fragile as it requires the user to know the has of the derivation.  What API can we give the client to set up the environment?  We could maybe auto-populate the PATH with the bin directory of the /nix/store path from the src attr?  How can the user expose other /nix/store paths so that they can address them logically?  This will also be required for us to implement the toolchain ideas.